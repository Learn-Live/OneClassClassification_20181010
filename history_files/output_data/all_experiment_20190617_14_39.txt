/usr/local/bin/python3.6 /Users/kunyang/PycharmProjects/anomaly_detection_20190611/autoencoder_main_20190612.py

Epochs = 100
AE_thres = trianing_loss * 5, around 1.5 for UNB


@@@train and evaluate AE on SYNT: uSc1C1_z-score_20_14

Step 1. loading data...

+Step 1-1. preprocessing data...
len(mu) = 0, len(d_std) = 0
the variance of the 18-th feature is 0.
the variance of the 21-th feature is 0.
**all_norm:77988, all_attack:74242
x_norm_train:(54591, 27), x_attack_train:0
x_norm_val:(7799, 27), x_attack_val:0
x_norm_test:(15598, 27), x_attack_test:(74242, 27)

Step 3. train and evaluate AE on case: uSc1C1_z-score_20_14

Step 3-1. train AE on case: uSc1C1_z-score_20_14
x_norm_train.shape: (54591, 27)
2019-06-16 16:18:10.779399: I tensorflow/core/platform/cpu_feature_guard.cc:140] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
AE training for Case :  uSc1C1_z-score_20_14  =  252.77352380752563 s
Train Loss =  0.10966730355464153 model.metrics_names ['loss']
Validation Loss =  0.12184284407617282 model.metrics_names ['loss']
training_losses:{'val_loss': [0.626138997709985, 0.4194650005772261, 0.3758612108151872, 0.34742237639543355, 0.32762166048176916, 0.30732746078182693, 0.28324041227176106, 0.269104730047917, 0.25874834617566167, 0.24374194148030398, 0.23523946121814604, 0.2296609922284376, 0.2223565090174919, 0.2072053371117442, 0.2085833438758224, 0.20354758450745436, 0.20291001033474962, 0.19702406746139128, 0.19353038953395818, 0.18884878260540738, 0.1835931629469829, 0.1737909012306102, 0.17812516489943292, 0.16822276364547165, 0.17139955412953278, 0.16719052326524084, 0.16688970887751928, 0.16108134242090175, 0.15940606441615804, 0.16247028458334725, 0.16416940779059433, 0.15586307243894104, 0.1670195274336825, 0.1608285059633431, 0.16463428002138875, 0.15458471246244265, 0.15293990581480643, 0.14798016804480021, 0.1500770744900701, 0.15509485875620935, 0.15282809024824517, 0.15332274948469965, 0.14976583008529865, 0.14419365624819203, 0.14508386188574687, 0.14680262752033027, 0.15114067632388284, 0.15178794377645952, 0.13753691923046651, 0.14704168434641135, 0.14459482086950165, 0.15017774435012657, 0.14300196433798337, 0.13814067861832155, 0.14153203698060715, 0.13570897345654337, 0.1343179666607376, 0.13967549381914973, 0.14518016539652587, 0.1381551262661423, 0.13688957630481716, 0.14213898764634947, 0.14332585410000132, 0.13103621066187893, 0.13200412569552036, 0.12863692981688346, 0.13106881143103227, 0.12847672375440902, 0.13656383026059293, 0.13548243385042835, 0.1306423395298921, 0.13580038725559812, 0.1303971073599653, 0.14350840739083298, 0.13209736932382887, 0.13299720173247626, 0.1319483000914559, 0.1356689328193313, 0.13713895712357818, 0.12702601186855664, 0.12927276111307137, 0.12640361040247863, 0.12637948345119243, 0.13478209282130535, 0.12041878324049315, 0.1280713375494914, 0.12300739121941102, 0.12196678841986447, 0.12829652545463277, 0.12182949216763382, 0.128263886047355, 0.12209779297490428, 0.12156891908985266, 0.11773994027878523, 0.11980412289374133, 0.12962001317029873, 0.12127556908669831, 0.11894052593291364, 0.12045753110405084, 0.12184284407617282], 'loss': [1.25860927547844, 0.48181968965597827, 0.38138558986508375, 0.34528797973552033, 0.3212260949966184, 0.30268948622214, 0.28201800973460883, 0.26386004812408537, 0.24902031350981105, 0.23604070526156526, 0.22544108193003795, 0.2172885052872749, 0.20911529084388428, 0.2035208933843027, 0.19731057801136107, 0.1919190087349276, 0.18792258781077095, 0.1830320091501608, 0.18037179378106388, 0.1783842462298743, 0.17318633636811656, 0.17122775097624712, 0.16849542356377475, 0.16507955531820798, 0.1629902259116143, 0.16070071883162926, 0.15762328418848512, 0.1570765411622211, 0.15655798334170112, 0.15334493118496928, 0.15236912884891018, 0.15162867953145204, 0.15089375007948727, 0.14954262935519774, 0.14976140679209654, 0.1475800459020211, 0.14528963091779457, 0.14482689593332934, 0.14360013480608763, 0.14357491390782104, 0.14195036592697916, 0.14038824910543551, 0.14132985421417243, 0.14075259812890972, 0.139195291993622, 0.13845586607375346, 0.13731214574651568, 0.1359191144864533, 0.13489416599987744, 0.13300780352324526, 0.1344866581312065, 0.13220291024384143, 0.133192916758803, 0.13153536106624578, 0.13079836539362802, 0.13024186234616797, 0.12918351894683575, 0.128902269035408, 0.1295946462656886, 0.12837238086144273, 0.12817015492284586, 0.12684494772349106, 0.1264849069555629, 0.12516327931642013, 0.1261945726093265, 0.12367559048157792, 0.12467361282741429, 0.12371485671866311, 0.12330333202800535, 0.12284629920170702, 0.1220243379967198, 0.12272969008542142, 0.12097959715477007, 0.12092343238727689, 0.1211994495522277, 0.12030247652755152, 0.11940784246287377, 0.1180858044112605, 0.11892318460118657, 0.11832165404242814, 0.11900928366082912, 0.11686853252271989, 0.11693524459447525, 0.11666237313491239, 0.11720542014857115, 0.11563928221451841, 0.11673268709432814, 0.11510731994786925, 0.11429520711346158, 0.11472443937346354, 0.11366676998383328, 0.11289417976408586, 0.11266744130368446, 0.11278358207480321, 0.11319786398716862, 0.11224488205981878, 0.11090465478450445, 0.11189781786866328, 0.11085617017508005, 0.11038313681750977]}
optimal_thres_AE_val:0.5607482494095759, factor = 5, key = loss
Test AE on train set on case: uSc1C1_z-score_20_14
x_norm_train.shape: (54591, 27)
AE Test time for  uSc1C1_z-score_20_14  = :  0.8722951412200928
[[    0     0]
 [ 1319 53272]]
tpr (recall): 0, fnr: 0, fpr: 0.024161491820996136, tnr: 0.9758385081790039, acc: 0.9758385081790039

Step 3-2. evaluate AE on case: uSc1C1_z-score_20_14

1). evaluate AE on test set:
x_test.shape: (89840, 27), case: uSc1C1_z-score_20_14
optimal_thres_AE 0.5607482494095759 achieved from key=loss, factor = 5, key = loss
AE Test time for  uSc1C1_z-score_20_14  = :  1.3147492408752441
[[74240     2]
 [  383 15215]]
tpr (recall): 0.9999730610705531, fnr: 2.693892944694378e-05, fpr: 0.024554430055135273, tnr: 0.9754455699448648, acc: 0.9957146037399822

save the FPR and FNR reausts of AE with num =27 features on test set.
output_pre_path:uSc1C1_z-score_20_14_recon_err_of_27_features
*the maximize reconstrcution error is 109.11920466401098 for Reconstruction loss of normal samples
Reconstr: out_file:Figures/uSc1C1_z-score_20_14_recon_err_of_27_features_reconstruct_loss_normal_data_rescon.pdf
*the maximize reconstrcution error is 109.11920466401098 for Reconstruction loss of normal samples in samples' order
*the maximize reconstrcution error is 162.13631595693985 for Reconstruction loss of attack samples
Reconstr: out_file:Figures/uSc1C1_z-score_20_14_recon_err_of_27_features_reconstruct_loss_attack_data_rescon.pdf
*the maximize reconstrcution error is 162.13631595693985 for Reconstruction loss of attack samples in samples' order

-Evaluate AE with different thresholds on test set with num = 27 features.
*** thres = 0.011544879848389037
AE Test time for  uSc1C1_z-score_20_14  = :  1.3762540817260742
[[74242     0]
 [15598     0]]
tpr (recall): 1.0, fnr: 0.0, fpr: 1.0, tnr: 0.0, acc: 0.826380231522707
*** thres = 0.06996338611000813
AE Test time for  uSc1C1_z-score_20_14  = :  1.3484699726104736
[[74242     0]
 [ 4516 11082]]
tpr (recall): 1.0, fnr: 0.0, fpr: 0.2895242979869214, tnr: 0.7104757020130786, acc: 0.9497328584149599
*** thres = 0.12838189237162723
AE Test time for  uSc1C1_z-score_20_14  = :  1.5883970260620117
[[74242     0]
 [ 1571 14027]]
tpr (recall): 1.0, fnr: 0.0, fpr: 0.10071804077445827, tnr: 0.8992819592255418, acc: 0.982513357079252
*** thres = 0.18680039863324632
AE Test time for  uSc1C1_z-score_20_14  = :  1.6521060466766357
[[74242     0]
 [  993 14605]]
tpr (recall): 1.0, fnr: 0.0, fpr: 0.06366200794973714, tnr: 0.9363379920502628, acc: 0.988947016918967
*** thres = 0.24521890489486542
AE Test time for  uSc1C1_z-score_20_14  = :  1.291334867477417
[[74242     0]
 [  751 14847]]
tpr (recall): 1.0, fnr: 0.0, fpr: 0.048147198358763944, tnr: 0.9518528016412361, acc: 0.9916406945681211
*** thres = 0.3036374111564845
AE Test time for  uSc1C1_z-score_20_14  = :  1.2829899787902832
[[74242     0]
 [  653 14945]]
tpr (recall): 1.0, fnr: 0.0, fpr: 0.04186434158225413, tnr: 0.9581356584177458, acc: 0.9927315227070347
*** thres = 0.3620559174181036
AE Test time for  uSc1C1_z-score_20_14  = :  1.2656869888305664
[[74242     0]
 [  591 15007]]
tpr (recall): 1.0, fnr: 0.0, fpr: 0.03788947300936017, tnr: 0.9621105269906398, acc: 0.9934216384683883
*** thres = 0.4204744236797227
AE Test time for  uSc1C1_z-score_20_14  = :  1.3836443424224854
[[74240     2]
 [  475 15123]]
tpr (recall): 0.9999730610705531, fnr: 2.693892944694378e-05, fpr: 0.030452622131042443, tnr: 0.9695473778689575, acc: 0.9946905609973286
*** thres = 0.4788929299413418
AE Test time for  uSc1C1_z-score_20_14  = :  1.3618357181549072
[[74240     2]
 [  422 15176]]
tpr (recall): 0.9999730610705531, fnr: 2.693892944694378e-05, fpr: 0.027054750609052443, tnr: 0.9729452493909475, acc: 0.995280498664292
*** thres = 0.537311436202961
AE Test time for  uSc1C1_z-score_20_14  = :  1.3443000316619873
[[74240     2]
 [  390 15208]]
tpr (recall): 0.9999730610705531, fnr: 2.693892944694378e-05, fpr: 0.025003205539171687, tnr: 0.9749967944608283, acc: 0.9956366874443455
*** thres = 0.59572994246458
AE Test time for  uSc1C1_z-score_20_14  = :  1.411175012588501
[[74240     2]
 [  369 15229]]
tpr (recall): 0.9999730610705531, fnr: 2.693892944694378e-05, fpr: 0.023656879087062443, tnr: 0.9763431209129375, acc: 0.9958704363312556
*** thres = 0.654148448726199
AE Test time for  uSc1C1_z-score_20_14  = :  1.3902037143707275
[[74240     2]
 [  357 15241]]
tpr (recall): 0.9999730610705531, fnr: 2.693892944694378e-05, fpr: 0.022887549685857163, tnr: 0.9771124503141428, acc: 0.9960040071237756
*** thres = 0.7125669549878182
AE Test time for  uSc1C1_z-score_20_14  = :  1.3713388442993164
[[74240     2]
 [  342 15256]]
tpr (recall): 0.9999730610705531, fnr: 2.693892944694378e-05, fpr: 0.021925887934350557, tnr: 0.9780741120656494, acc: 0.9961709706144256
*** thres = 0.7709854612494373
AE Test time for  uSc1C1_z-score_20_14  = :  1.526569128036499
[[74240     2]
 [  333 15265]]
tpr (recall): 0.9999730610705531, fnr: 2.693892944694378e-05, fpr: 0.021348890883446596, tnr: 0.9786511091165534, acc: 0.9962711487088157
*** thres = 0.8294039675110564
AE Test time for  uSc1C1_z-score_20_14  = :  1.3534197807312012
[[74240     2]
 [  323 15275]]
tpr (recall): 0.9999730610705531, fnr: 2.693892944694378e-05, fpr: 0.02070778304910886, tnr: 0.9792922169508912, acc: 0.9963824577025824
*** thres = 0.8878224737726754
AE Test time for  uSc1C1_z-score_20_14  = :  1.2669308185577393
[[74240     2]
 [  311 15287]]
tpr (recall): 0.9999730610705531, fnr: 2.693892944694378e-05, fpr: 0.019938453647903576, tnr: 0.9800615463520964, acc: 0.9965160284951025
*** thres = 0.9462409800342946
AE Test time for  uSc1C1_z-score_20_14  = :  1.4092779159545898
[[74240     2]
 [  294 15304]]
tpr (recall): 0.9999730610705531, fnr: 2.693892944694378e-05, fpr: 0.018848570329529427, tnr: 0.9811514296704705, acc: 0.9967052537845058
*** thres = 1.0046594862959137
AE Test time for  uSc1C1_z-score_20_14  = :  1.8011891841888428
[[74240     2]
 [  290 15308]]
tpr (recall): 0.9999730610705531, fnr: 2.693892944694378e-05, fpr: 0.018592127195794332, tnr: 0.9814078728042057, acc: 0.9967497773820124
*** thres = 1.0630779925575329
AE Test time for  uSc1C1_z-score_20_14  = :  1.3549470901489258
[[74240     2]
 [  282 15316]]
tpr (recall): 0.9999730610705531, fnr: 2.693892944694378e-05, fpr: 0.018079240928324143, tnr: 0.9819207590716759, acc: 0.9968388245770258
*** thres = 1.1214964988191518
AE Test time for  uSc1C1_z-score_20_14  = :  1.4294300079345703
[[74240     2]
 [  199 15399]]
tpr (recall): 0.9999730610705531, fnr: 2.693892944694378e-05, fpr: 0.012758045903320938, tnr: 0.987241954096679, acc: 0.9977626892252894
AE_thres: out_file:Figures/uSc1C1_z-score_20_14_thres_res_metrics_of_27_features_AE_thres.pdf

2). no need to evaluate DT on test set

3). train and evaluate PCA...
PCA Training time for case uSc1C1_z-score_20_14  =  0.17316293716430664
x_test.shape: (89840, 27)
PCA Testing Time :  0.10763406753540039
[[73003  1239]
 [ 1576 14022]]
tpr (recall): 0.9833113332076183, fnr: 0.016688666792381672, fpr: 0.10103859469162713, tnr: 0.8989614053083729, acc: 0.968666518254675

4). train and evaluate IF...
/usr/local/lib/python3.6/site-packages/sklearn/ensemble/iforest.py:213: FutureWarning: default contamination parameter 0.1 will change in version 0.22 to "auto". This will change the predict method behavior.
  FutureWarning)
/usr/local/lib/python3.6/site-packages/sklearn/ensemble/iforest.py:223: FutureWarning: behaviour="old" is deprecated and will be removed in version 0.22. Please use behaviour="new", which makes the decision_function change to match other anomaly detection algorithm API.
  FutureWarning)
IF Training time for case uSc1C1_z-score_20_14  =  3.6597530841827393
x_norm_train.shape: (54591, 27)
/usr/local/lib/python3.6/site-packages/sklearn/ensemble/iforest.py:417: DeprecationWarning: threshold_ attribute is deprecated in 0.20 and will be removed in 0.22.
  " be removed in 0.22.", DeprecationWarning)
IF Testing Time :  1.6468579769134521
[[    0     0]
 [ 5454 49137]]
tpr (recall): 0, fnr: 0, fpr: 0.09990657800736386, tnr: 0.9000934219926362, acc: 0.9000934219926362
x_test.shape: (89840, 27)
/usr/local/lib/python3.6/site-packages/sklearn/ensemble/iforest.py:417: DeprecationWarning: threshold_ attribute is deprecated in 0.20 and will be removed in 0.22.
  " be removed in 0.22.", DeprecationWarning)
IF Testing Time :  2.2453370094299316
[[73933   309]
 [ 1548 14050]]
tpr (recall): 0.9958379354004472, fnr: 0.004162064599552814, fpr: 0.09924349275548147, tnr: 0.9007565072445185, acc: 0.9793299198575245
key:DT, value:[]
key:OCSVM, value:[]
ROC:out_file:Figures/uSc1C1_z-score_20_14_roc_data_of_27_features_ROC.pdf

@@@train and evaluate AE on UNB: uSc1C2_z-score_20_14

Step 1. loading data...

+Step 1-1. preprocessing data...
len(mu) = 0, len(d_std) = 0
the variance of the 18-th feature is 0.
the variance of the 24-th feature is 0.
**all_norm:59832, all_attack:35953
x_norm_train:(41881, 27), x_attack_train:0
x_norm_val:(5984, 27), x_attack_val:0
x_norm_test:(11967, 27), x_attack_test:(35953, 27)

Step 3. train and evaluate AE on case: uSc1C2_z-score_20_14

Step 3-1. train AE on case: uSc1C2_z-score_20_14
x_norm_train.shape: (41881, 27)
AE training for Case :  uSc1C2_z-score_20_14  =  200.45907998085022 s
Train Loss =  0.4375484411221931 model.metrics_names ['loss']
Validation Loss =  0.4027484550195582 model.metrics_names ['loss']
training_losses:{'val_loss': [0.8670263492806073, 0.6819276369829229, 0.6174187951865681, 0.576435012533703, 0.5553169289534104, 0.5398426828059283, 0.527061173622621, 0.514762398074655, 0.5040468929763784, 0.49657293373250705, 0.4881286805963771, 0.4828260657302836, 0.4788417449609481, 0.47399725498043915, 0.4688106433433645, 0.4660906816389471, 0.4668565400462737, 0.465774644983006, 0.46120027695747623, 0.46208613887827665, 0.45444902498773077, 0.4556719832082483, 0.45650558962541465, 0.45028572828374447, 0.4518996922568204, 0.4533085793575501, 0.4555437540944247, 0.44470988931184147, 0.4454968164470744, 0.444286489869184, 0.4452989303013858, 0.4426512036890907, 0.43845201494859504, 0.4363041237235707, 0.4395314475750541, 0.43506032332060807, 0.43088808751361257, 0.44357197265574, 0.43781147251792135, 0.4389079401996684, 0.43494041319836907, 0.4381505960130437, 0.4321717886841871, 0.4344252233996111, 0.4337464447486847, 0.4323470405238197, 0.4297541514596837, 0.4264331915799309, 0.4271228978818751, 0.42578861348450503, 0.4273512415229318, 0.42416923513068233, 0.42421486655021096, 0.4246471529816561, 0.4274113934467183, 0.4265230160186635, 0.4269514756406692, 0.4235569461781711, 0.4234996648395763, 0.42593981222035415, 0.4234299831052515, 0.42509584973521414, 0.4214412303053759, 0.4244895822064762, 0.4221283498613592, 0.41908610010529584, 0.41593365817465244, 0.41515261317319413, 0.4175524623158144, 0.415031076354139, 0.4162338480433041, 0.41690303807590096, 0.41141065660326237, 0.4165491115919409, 0.41182072723613067, 0.4086016301005919, 0.4103423517974303, 0.41466045626663267, 0.417639030492242, 0.41077563565045117, 0.4125491171915901, 0.41945660871299195, 0.4157168293063016, 0.4080061685433362, 0.4068385525980098, 0.41306719080330856, 0.4076794048840987, 0.40456022808258546, 0.407267792578687, 0.40625157155455116, 0.4056212171354396, 0.40890649502927606, 0.4088897013409252, 0.4051735822689087, 0.404269466027219, 0.4026289991835222, 0.40384699922194456, 0.41161939748786985, 0.407878642094964, 0.4027484550195582], 'loss': [1.4855556588372045, 0.7986465814089081, 0.6858299991690052, 0.632394435946202, 0.6024815343621552, 0.583943533251556, 0.5704540497297851, 0.558190030824893, 0.5470168687408006, 0.535235454398517, 0.5267197906655029, 0.5209067857330085, 0.5161469149316571, 0.5116741873311642, 0.5084402424362201, 0.5047842156938005, 0.5023251231384864, 0.5001295063566283, 0.4975312456671134, 0.49530894249454926, 0.4936643519675031, 0.49166773709688183, 0.48938291511928217, 0.4882520654675658, 0.48646433480913487, 0.48495126117542714, 0.4837113461680656, 0.4823470135312325, 0.4809425137283291, 0.4795262972531387, 0.47851804799050546, 0.47704185382809383, 0.4763324270247047, 0.47541138708512476, 0.4747978769092795, 0.4738248142661897, 0.4726444949410609, 0.4720986712522856, 0.4713110680273413, 0.4708676324433548, 0.47036313547442743, 0.4691552795897252, 0.4687382322739531, 0.46788647923732324, 0.4677932260499347, 0.4674150692356603, 0.46642072410382657, 0.4658579934062044, 0.46564479126225133, 0.46470018901159127, 0.46408326534853633, 0.46350068397728733, 0.4628347818920524, 0.4621186658488495, 0.46182593457556104, 0.4610087973658322, 0.4605291807505785, 0.4605062018940896, 0.4597297770163923, 0.4596591882116089, 0.458610446828646, 0.4584147270325646, 0.4575100119693844, 0.4571056055867801, 0.45581586433272175, 0.4547719953921522, 0.4553329705094737, 0.45263586459726624, 0.4522859925259515, 0.45161477588915, 0.451134283595405, 0.45043169922335224, 0.45012243713389516, 0.4492368798369662, 0.4493428927918013, 0.44827534879268105, 0.44843492399686696, 0.4473287273491099, 0.44759096419816086, 0.44641530669816276, 0.44616881099233074, 0.445841930129376, 0.44560543412775805, 0.4458819587385924, 0.44519238815322476, 0.44536602715916385, 0.44474699319978744, 0.4443312937088288, 0.44333026084860966, 0.4436381635612154, 0.44262996595470744, 0.4423469606242507, 0.4416416824363523, 0.4410209653875991, 0.4408983254850527, 0.44074554030107527, 0.43979069690120726, 0.43911408025451426, 0.4384596429727688, 0.4371563917056745]}
optimal_thres_AE_val:2.201902126011601, factor = 5, key = loss
Test AE on train set on case: uSc1C2_z-score_20_14
x_norm_train.shape: (41881, 27)
AE Test time for  uSc1C2_z-score_20_14  = :  0.677994966506958
[[    0     0]
 [ 1402 40479]]
tpr (recall): 0, fnr: 0, fpr: 0.03347580048231895, tnr: 0.9665241995176811, acc: 0.9665241995176811

Step 3-2. evaluate AE on case: uSc1C2_z-score_20_14

1). evaluate AE on test set:
x_test.shape: (47920, 27), case: uSc1C2_z-score_20_14
optimal_thres_AE 2.201902126011601 achieved from key=loss, factor = 5, key = loss
AE Test time for  uSc1C2_z-score_20_14  = :  0.773730993270874
[[35953     0]
 [  398 11569]]
tpr (recall): 1.0, fnr: 0.0, fpr: 0.033258126514581765, tnr: 0.9667418734854182, acc: 0.9916944908180301

save the FPR and FNR reausts of AE with num =27 features on test set.
output_pre_path:uSc1C2_z-score_20_14_recon_err_of_27_features
*the maximize reconstrcution error is 47.731742915661194 for Reconstruction loss of normal samples
Reconstr: out_file:Figures/uSc1C2_z-score_20_14_recon_err_of_27_features_reconstruct_loss_normal_data_rescon.pdf
*the maximize reconstrcution error is 47.731742915661194 for Reconstruction loss of normal samples in samples' order
*the maximize reconstrcution error is 72.63975467269914 for Reconstruction loss of attack samples
Reconstr: out_file:Figures/uSc1C2_z-score_20_14_recon_err_of_27_features_reconstruct_loss_attack_data_rescon.pdf
*the maximize reconstrcution error is 72.63975467269914 for Reconstruction loss of attack samples in samples' order

-Evaluate AE with different thresholds on test set with num = 27 features.
*** thres = 0.022588496883909095
AE Test time for  uSc1C2_z-score_20_14  = :  0.7985043525695801
[[35953     0]
 [11967     0]]
tpr (recall): 1.0, fnr: 0.0, fpr: 1.0, tnr: 0.0, acc: 0.750271285475793
*** thres = 0.2531787997859772
AE Test time for  uSc1C2_z-score_20_14  = :  0.7964379787445068
[[35953     0]
 [ 3937  8030]]
tpr (recall): 1.0, fnr: 0.0, fpr: 0.3289880504721317, tnr: 0.6710119495278684, acc: 0.9178422370617696
*** thres = 0.48376910268804524
AE Test time for  uSc1C2_z-score_20_14  = :  0.8283090591430664
[[35953     0]
 [ 1994  9973]]
tpr (recall): 1.0, fnr: 0.0, fpr: 0.16662488510069356, tnr: 0.8333751148993064, acc: 0.9583889816360601
*** thres = 0.7143594055901133
AE Test time for  uSc1C2_z-score_20_14  = :  0.9323539733886719
[[35953     0]
 [ 1325 10642]]
tpr (recall): 1.0, fnr: 0.0, fpr: 0.11072114982869558, tnr: 0.8892788501713044, acc: 0.9723497495826378
*** thres = 0.9449497084921814
AE Test time for  uSc1C2_z-score_20_14  = :  0.9220139980316162
[[35953     0]
 [  997 10970]]
tpr (recall): 1.0, fnr: 0.0, fpr: 0.08331244255034678, tnr: 0.9166875574496532, acc: 0.97919449081803
*** thres = 1.1755400113942496
AE Test time for  uSc1C2_z-score_20_14  = :  0.8944127559661865
[[35953     0]
 [  840 11127]]
tpr (recall): 1.0, fnr: 0.0, fpr: 0.0701930308347957, tnr: 0.9298069691652043, acc: 0.9824707846410684
*** thres = 1.4061303142963177
AE Test time for  uSc1C2_z-score_20_14  = :  0.8809969425201416
[[35953     0]
 [  720 11247]]
tpr (recall): 1.0, fnr: 0.0, fpr: 0.06016545500125345, tnr: 0.9398345449987465, acc: 0.9849749582637729
*** thres = 1.6367206171983857
AE Test time for  uSc1C2_z-score_20_14  = :  1.0258989334106445
[[35953     0]
 [  521 11446]]
tpr (recall): 1.0, fnr: 0.0, fpr: 0.043536391743962566, tnr: 0.9564636082560375, acc: 0.989127712854758
*** thres = 1.8673109201004539
AE Test time for  uSc1C2_z-score_20_14  = :  0.8449039459228516
[[35953     0]
 [  465 11502]]
tpr (recall): 1.0, fnr: 0.0, fpr: 0.03885685635497618, tnr: 0.9611431436450238, acc: 0.99029632721202
*** thres = 2.0979012230025216
AE Test time for  uSc1C2_z-score_20_14  = :  0.8472809791564941
[[35953     0]
 [  423 11544]]
tpr (recall): 1.0, fnr: 0.0, fpr: 0.0353472048132364, tnr: 0.9646527951867636, acc: 0.9911727879799667
*** thres = 2.3284915259045897
AE Test time for  uSc1C2_z-score_20_14  = :  0.8638043403625488
[[35953     0]
 [  365 11602]]
tpr (recall): 1.0, fnr: 0.0, fpr: 0.03050054316035765, tnr: 0.9694994568396423, acc: 0.9923831385642737
*** thres = 2.559081828806658
AE Test time for  uSc1C2_z-score_20_14  = :  0.9486160278320312
[[35953     0]
 [  344 11623]]
tpr (recall): 1.0, fnr: 0.0, fpr: 0.02874571738948776, tnr: 0.9712542826105123, acc: 0.9928213689482471
*** thres = 2.789672131708726
AE Test time for  uSc1C2_z-score_20_14  = :  0.847919225692749
[[35953     0]
 [  326 11641]]
tpr (recall): 1.0, fnr: 0.0, fpr: 0.027241581014456423, tnr: 0.9727584189855436, acc: 0.9931969949916527
*** thres = 3.0202624346107942
AE Test time for  uSc1C2_z-score_20_14  = :  0.9456079006195068
[[35953     0]
 [  321 11646]]
tpr (recall): 1.0, fnr: 0.0, fpr: 0.026823765354725495, tnr: 0.9731762346452745, acc: 0.9933013355592655
*** thres = 3.250852737512862
AE Test time for  uSc1C2_z-score_20_14  = :  1.2121260166168213
[[35953     0]
 [  277 11690]]
tpr (recall): 1.0, fnr: 0.0, fpr: 0.02314698754909334, tnr: 0.9768530124509066, acc: 0.9942195325542571
*** thres = 3.48144304041493
AE Test time for  uSc1C2_z-score_20_14  = :  1.2135438919067383
[[35953     0]
 [  261 11706]]
tpr (recall): 1.0, fnr: 0.0, fpr: 0.021809977437954375, tnr: 0.9781900225620457, acc: 0.9945534223706177
*** thres = 3.7120333433169983
AE Test time for  uSc1C2_z-score_20_14  = :  1.1307721138000488
[[35953     0]
 [  248 11719]]
tpr (recall): 1.0, fnr: 0.0, fpr: 0.020723656722653964, tnr: 0.979276343277346, acc: 0.9948247078464106
*** thres = 3.9426236462190665
AE Test time for  uSc1C2_z-score_20_14  = :  1.0832929611206055
[[35953     0]
 [  242 11725]]
tpr (recall): 1.0, fnr: 0.0, fpr: 0.02022227793097685, tnr: 0.9797777220690231, acc: 0.9949499165275459
*** thres = 4.173213949121134
AE Test time for  uSc1C2_z-score_20_14  = :  0.9709210395812988
[[35953     0]
 [  238 11729]]
tpr (recall): 1.0, fnr: 0.0, fpr: 0.019888025403192112, tnr: 0.9801119745968079, acc: 0.9950333889816361
*** thres = 4.403804252023202
AE Test time for  uSc1C2_z-score_20_14  = :  1.0783331394195557
[[35953     0]
 [  236 11731]]
tpr (recall): 1.0, fnr: 0.0, fpr: 0.019720899139299742, tnr: 0.9802791008607002, acc: 0.9950751252086811
AE_thres: out_file:Figures/uSc1C2_z-score_20_14_thres_res_metrics_of_27_features_AE_thres.pdf

2). no need to evaluate DT on test set

3). train and evaluate PCA...
PCA Training time for case uSc1C2_z-score_20_14  =  0.1364750862121582
x_test.shape: (47920, 27)
PCA Testing Time :  0.0572810173034668
[[35953     0]
 [ 1150 10817]]
tpr (recall): 1.0, fnr: 0.0, fpr: 0.09609760173811314, tnr: 0.9039023982618869, acc: 0.9760016694490818
/usr/local/lib/python3.6/site-packages/sklearn/ensemble/iforest.py:213: FutureWarning: default contamination parameter 0.1 will change in version 0.22 to "auto". This will change the predict method behavior.
  FutureWarning)
/usr/local/lib/python3.6/site-packages/sklearn/ensemble/iforest.py:223: FutureWarning: behaviour="old" is deprecated and will be removed in version 0.22. Please use behaviour="new", which makes the decision_function change to match other anomaly detection algorithm API.
  FutureWarning)

4). train and evaluate IF...
IF Training time for case uSc1C2_z-score_20_14  =  2.642096996307373
x_norm_train.shape: (41881, 27)
/usr/local/lib/python3.6/site-packages/sklearn/ensemble/iforest.py:417: DeprecationWarning: threshold_ attribute is deprecated in 0.20 and will be removed in 0.22.
  " be removed in 0.22.", DeprecationWarning)
IF Testing Time :  1.1235740184783936
[[    0     0]
 [ 4188 37693]]
tpr (recall): 0, fnr: 0, fpr: 0.09999761228241924, tnr: 0.9000023877175808, acc: 0.9000023877175808
x_test.shape: (47920, 27)
/usr/local/lib/python3.6/site-packages/sklearn/ensemble/iforest.py:417: DeprecationWarning: threshold_ attribute is deprecated in 0.20 and will be removed in 0.22.
  " be removed in 0.22.", DeprecationWarning)
IF Testing Time :  1.1704809665679932
[[18469 17484]
 [ 1165 10802]]
tpr (recall): 0.5136984396295163, fnr: 0.48630156037048367, fpr: 0.09735104871730592, tnr: 0.9026489512826941, acc: 0.610830550918197
key:DT, value:[]
key:OCSVM, value:[]
ROC:out_file:Figures/uSc1C2_z-score_20_14_roc_data_of_27_features_ROC.pdf

@@@train and evaluate AE on MAWI: uSc1C3_z-score_20_14

Step 1. loading data...

+Step 1-1. preprocessing data...
len(mu) = 0, len(d_std) = 0
the variance of the 24-th feature is 0.
all_norm:62000, all_attack:0
x_norm_train:(43400, 27), x_attack_train:0
x_norm_val:(6200, 27), x_attack_val:0
x_norm_test:(12400, 27), x_attack_test:0

Step 3. train and evaluate AE on case: uSc1C3_z-score_20_14

Step 3-1. train AE on case: uSc1C3_z-score_20_14
x_norm_train.shape: (43400, 27)
AE training for Case :  uSc1C3_z-score_20_14  =  257.3108730316162 s
Train Loss =  0.22279759527952303 model.metrics_names ['loss']
Validation Loss =  0.22458530740391824 model.metrics_names ['loss']
training_losses:{'val_loss': [0.5804542053899457, 0.4841058725118637, 0.43468537309477406, 0.4065342260176136, 0.3895954615646793, 0.3737979948328387, 0.3556919507634255, 0.3440057993319727, 0.33546559097305423, 0.32411192703631614, 0.30729752113742215, 0.2980137825973572, 0.2894128598224732, 0.28578770716344154, 0.27621177602198815, 0.2723455289871462, 0.28517228428394564, 0.27857352747071173, 0.26901882396590326, 0.2747034294278391, 0.26116055613563904, 0.26073099507439523, 0.26535587600161953, 0.261599519752687, 0.26102787942655625, 0.2571014943526637, 0.2654080741828488, 0.2569566436159995, 0.2574846452282321, 0.2677576039106615, 0.25314465049774415, 0.2532072780401476, 0.2568300280551757, 0.2509722325590349, 0.25057913024579326, 0.24994907623337162, 0.24807211964361128, 0.28440635202392456, 0.24799545698588893, 0.24448862096955698, 0.24342665337747144, 0.25367021022304415, 0.24242994151769146, 0.24847081104593893, 0.2469511957610807, 0.24446648811140367, 0.24707399421161222, 0.24197470096811172, 0.2431695123353312, 0.2405046651632555, 0.2422133563362783, 0.23677478910453859, 0.24081510419326443, 0.23969666648295618, 0.23886274799704552, 0.23956675187233956, 0.2368748115916406, 0.23708920895091948, 0.23801291953171452, 0.2395272651218599, 0.2390392298179288, 0.2350792730623676, 0.23839154556874306, 0.23612613164609478, 0.2344655080476115, 0.23365959305917064, 0.23798672892393605, 0.23753351968142294, 0.23514517600497892, 0.229626434560745, 0.23529948735910078, 0.23635307166845568, 0.22980199965738482, 0.2256720888133972, 0.2257121120537481, 0.230158679514162, 0.2267106550835794, 0.23095816592535665, 0.2279336093366146, 0.2342123071609005, 0.22869350627545387, 0.23449482744739902, 0.22695343132941953, 0.22571677247843436, 0.23105099405492505, 0.22479970706086005, 0.22170436765878432, 0.22688282507081187, 0.22797351438672311, 0.2261659183040742, 0.23175930644235304, 0.2262702100748016, 0.22233217551342901, 0.23346292615898193, 0.22060439272272972, 0.22055054137302982, 0.2198264528089954, 0.22363859116069731, 0.25431716016223355, 0.22458530740391824], 'loss': [1.0743316217027776, 0.5419341013783134, 0.47313819155715026, 0.435072710345143, 0.4114740855875103, 0.39367206373522357, 0.3786430468523557, 0.3641490129762531, 0.35252895466124956, 0.3413634028701189, 0.3321043681494102, 0.32205305135332496, 0.3132807395878475, 0.30648081899650637, 0.3009814662901762, 0.29616135589950093, 0.29218433767557145, 0.28768790137657924, 0.2855718119257057, 0.28175454821454765, 0.2795196601913272, 0.2778359308275759, 0.2757701142661033, 0.2743219598509749, 0.27193384931109466, 0.26986187701126396, 0.2684714248831371, 0.26793390828257746, 0.26612600545583437, 0.26405686517121607, 0.26365943181830614, 0.26226535656691147, 0.2607415209834202, 0.2598093119524591, 0.2587764107161266, 0.2589319168923912, 0.2577165797977678, 0.25629875720714645, 0.25596930181307176, 0.2549649918621861, 0.25358591026150135, 0.2530903416013663, 0.25210125649579657, 0.25140792355078706, 0.25109170717921125, 0.2502830468303597, 0.24955379194858987, 0.24926030399337892, 0.2488699470000333, 0.24819003703819442, 0.2477844232492458, 0.24679712217249627, 0.2457649693174571, 0.24490441881635222, 0.2448115748633987, 0.2442905755979674, 0.24419265753456523, 0.24366040751956025, 0.2424951692097198, 0.2428072014258754, 0.24169397242813614, 0.2407113414020857, 0.24134600054489852, 0.2407662052781351, 0.2401074004053108, 0.2389361335543169, 0.2403104786590291, 0.23858994825661595, 0.23772830204411585, 0.23683798279355747, 0.23587191491769754, 0.23466606101407433, 0.23462906125538086, 0.234117929252886, 0.23306571711180946, 0.23256236767713925, 0.23151080811284655, 0.23122707511148144, 0.23052902854876034, 0.22995260031095574, 0.22938966682017672, 0.2287709848218799, 0.22897098854458828, 0.22923384749841305, 0.22818613835125476, 0.2274880041532253, 0.22818974487208826, 0.22748202055967348, 0.22708797806281647, 0.22759275689309094, 0.22592360634717248, 0.22638911830252767, 0.22750563859561895, 0.22511130974452068, 0.22625047778650637, 0.22473879721238865, 0.22477125942707063, 0.2259924056710598, 0.22468990158993526, 0.22588129643539678]}
optimal_thres_AE_val:1.1286269055560987, factor = 5, key = loss
Test AE on train set on case: uSc1C3_z-score_20_14
x_norm_train.shape: (43400, 27)
AE Test time for  uSc1C3_z-score_20_14  = :  0.9623360633850098
[[    0     0]
 [ 2045 41355]]
tpr (recall): 0, fnr: 0, fpr: 0.047119815668202766, tnr: 0.9528801843317972, acc: 0.9528801843317972

Step 3-2. evaluate AE on case: uSc1C3_z-score_20_14

1). evaluate AE on test set:
x_test.shape: (12400, 27), case: uSc1C3_z-score_20_14
optimal_thres_AE 1.1286269055560987 achieved from key=loss, factor = 5, key = loss
AE Test time for  uSc1C3_z-score_20_14  = :  0.41161298751831055
[[    0     0]
 [  559 11841]]
tpr (recall): 0, fnr: 0, fpr: 0.045080645161290324, tnr: 0.9549193548387097, acc: 0.9549193548387097

save the FPR and FNR reausts of AE with num =27 features on test set.

-Evaluate AE with different thresholds on test set with num = 27 features.
*** thres = 0.003870918149471244
AE Test time for  uSc1C3_z-score_20_14  = :  0.4075307846069336
[[    0     0]
 [12400     0]]
tpr (recall): 0, fnr: 0, fpr: 1.0, tnr: 0.0, acc: 0.0
*** thres = 0.1224700177790884
AE Test time for  uSc1C3_z-score_20_14  = :  0.4604380130767822
[[    0     0]
 [ 1621 10779]]
tpr (recall): 0, fnr: 0, fpr: 0.1307258064516129, tnr: 0.8692741935483871, acc: 0.8692741935483871
*** thres = 0.24106911740870557
AE Test time for  uSc1C3_z-score_20_14  = :  0.44081711769104004
[[    0     0]
 [ 1449 10951]]
tpr (recall): 0, fnr: 0, fpr: 0.11685483870967742, tnr: 0.8831451612903226, acc: 0.8831451612903226
*** thres = 0.35966821703832275
AE Test time for  uSc1C3_z-score_20_14  = :  0.42337894439697266
[[    0     0]
 [ 1137 11263]]
tpr (recall): 0, fnr: 0, fpr: 0.09169354838709677, tnr: 0.9083064516129032, acc: 0.9083064516129032
*** thres = 0.4782673166679399
AE Test time for  uSc1C3_z-score_20_14  = :  0.4609711170196533
[[    0     0]
 [ 1003 11397]]
tpr (recall): 0, fnr: 0, fpr: 0.08088709677419355, tnr: 0.9191129032258064, acc: 0.9191129032258064
*** thres = 0.5968664162975571
AE Test time for  uSc1C3_z-score_20_14  = :  0.43938612937927246
[[    0     0]
 [  858 11542]]
tpr (recall): 0, fnr: 0, fpr: 0.06919354838709678, tnr: 0.9308064516129032, acc: 0.9308064516129032
*** thres = 0.7154655159271742
AE Test time for  uSc1C3_z-score_20_14  = :  0.43515896797180176
[[    0     0]
 [  754 11646]]
tpr (recall): 0, fnr: 0, fpr: 0.060806451612903226, tnr: 0.9391935483870968, acc: 0.9391935483870968
*** thres = 0.8340646155567915
AE Test time for  uSc1C3_z-score_20_14  = :  0.43038105964660645
[[    0     0]
 [  693 11707]]
tpr (recall): 0, fnr: 0, fpr: 0.05588709677419355, tnr: 0.9441129032258064, acc: 0.9441129032258064
*** thres = 0.9526637151864086
AE Test time for  uSc1C3_z-score_20_14  = :  0.5523459911346436
[[    0     0]
 [  624 11776]]
tpr (recall): 0, fnr: 0, fpr: 0.05032258064516129, tnr: 0.9496774193548387, acc: 0.9496774193548387
*** thres = 1.0712628148160257
AE Test time for  uSc1C3_z-score_20_14  = :  0.6957290172576904
[[    0     0]
 [  583 11817]]
tpr (recall): 0, fnr: 0, fpr: 0.04701612903225806, tnr: 0.952983870967742, acc: 0.952983870967742
*** thres = 1.1898619144456428
AE Test time for  uSc1C3_z-score_20_14  = :  0.5663008689880371
[[    0     0]
 [  536 11864]]
tpr (recall): 0, fnr: 0, fpr: 0.043225806451612905, tnr: 0.9567741935483871, acc: 0.9567741935483871
*** thres = 1.30846101407526
AE Test time for  uSc1C3_z-score_20_14  = :  0.62841796875
[[    0     0]
 [  496 11904]]
tpr (recall): 0, fnr: 0, fpr: 0.04, tnr: 0.96, acc: 0.96
*** thres = 1.427060113704877
AE Test time for  uSc1C3_z-score_20_14  = :  0.6315138339996338
[[    0     0]
 [  484 11916]]
tpr (recall): 0, fnr: 0, fpr: 0.03903225806451613, tnr: 0.9609677419354838, acc: 0.9609677419354838
*** thres = 1.5456592133344942
AE Test time for  uSc1C3_z-score_20_14  = :  0.472898006439209
[[    0     0]
 [  464 11936]]
tpr (recall): 0, fnr: 0, fpr: 0.03741935483870968, tnr: 0.9625806451612903, acc: 0.9625806451612903
*** thres = 1.6642583129641115
AE Test time for  uSc1C3_z-score_20_14  = :  0.5301320552825928
[[    0     0]
 [  438 11962]]
tpr (recall): 0, fnr: 0, fpr: 0.03532258064516129, tnr: 0.9646774193548387, acc: 0.9646774193548387
*** thres = 1.7828574125937287
AE Test time for  uSc1C3_z-score_20_14  = :  0.500607967376709
[[    0     0]
 [  420 11980]]
tpr (recall): 0, fnr: 0, fpr: 0.03387096774193549, tnr: 0.9661290322580646, acc: 0.9661290322580646
*** thres = 1.9014565122233458
AE Test time for  uSc1C3_z-score_20_14  = :  0.48816800117492676
[[    0     0]
 [  406 11994]]
tpr (recall): 0, fnr: 0, fpr: 0.03274193548387097, tnr: 0.9672580645161291, acc: 0.9672580645161291
*** thres = 2.020055611852963
AE Test time for  uSc1C3_z-score_20_14  = :  0.5251059532165527
[[    0     0]
 [  389 12011]]
tpr (recall): 0, fnr: 0, fpr: 0.031370967741935485, tnr: 0.9686290322580645, acc: 0.9686290322580645
*** thres = 2.1386547114825802
AE Test time for  uSc1C3_z-score_20_14  = :  0.47220420837402344
[[    0     0]
 [  364 12036]]
tpr (recall): 0, fnr: 0, fpr: 0.02935483870967742, tnr: 0.9706451612903226, acc: 0.9706451612903226
*** thres = 2.2572538111121974
AE Test time for  uSc1C3_z-score_20_14  = :  0.4911468029022217
[[    0     0]
 [  352 12048]]
tpr (recall): 0, fnr: 0, fpr: 0.02838709677419355, tnr: 0.9716129032258064, acc: 0.9716129032258064
AE_thres: out_file:Figures/uSc1C3_z-score_20_14_thres_res_metrics_of_27_features_AE_thres.pdf

2). no need to evaluate DT on test set

3). train and evaluate PCA...
PCA Training time for case uSc1C3_z-score_20_14  =  0.15311717987060547
x_test.shape: (12400, 27)
PCA Testing Time :  0.013603925704956055
[[    0     0]
 [ 1023 11377]]
tpr (recall): 0, fnr: 0, fpr: 0.0825, tnr: 0.9175, acc: 0.9175

4). train and evaluate IF...
/usr/local/lib/python3.6/site-packages/sklearn/ensemble/iforest.py:213: FutureWarning: default contamination parameter 0.1 will change in version 0.22 to "auto". This will change the predict method behavior.
  FutureWarning)
/usr/local/lib/python3.6/site-packages/sklearn/ensemble/iforest.py:223: FutureWarning: behaviour="old" is deprecated and will be removed in version 0.22. Please use behaviour="new", which makes the decision_function change to match other anomaly detection algorithm API.
  FutureWarning)
IF Training time for case uSc1C3_z-score_20_14  =  2.3278110027313232
x_norm_train.shape: (43400, 27)
/usr/local/lib/python3.6/site-packages/sklearn/ensemble/iforest.py:417: DeprecationWarning: threshold_ attribute is deprecated in 0.20 and will be removed in 0.22.
  " be removed in 0.22.", DeprecationWarning)
IF Testing Time :  0.9710540771484375
[[    0     0]
 [ 4340 39060]]
tpr (recall): 0, fnr: 0, fpr: 0.1, tnr: 0.9, acc: 0.9
x_test.shape: (12400, 27)
/usr/local/lib/python3.6/site-packages/sklearn/ensemble/iforest.py:417: DeprecationWarning: threshold_ attribute is deprecated in 0.20 and will be removed in 0.22.
  " be removed in 0.22.", DeprecationWarning)
IF Testing Time :  0.3174779415130615
[[    0     0]
 [ 1184 11216]]
tpr (recall): 0, fnr: 0, fpr: 0.09548387096774194, tnr: 0.9045161290322581, acc: 0.9045161290322581
key:DT, value:[]
key:OCSVM, value:[]
/usr/local/lib/python3.6/site-packages/sklearn/metrics/ranking.py:648: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  UndefinedMetricWarning)
/usr/local/lib/python3.6/site-packages/sklearn/metrics/ranking.py:114: RuntimeWarning: invalid value encountered in less
  if np.any(dx < 0):
ROC:out_file:Figures/uSc1C3_z-score_20_14_roc_data_of_27_features_ROC.pdf

@@@train on UNB: uSc2C2_z-score_20_14

Step 1. loading data...

+Step 1-1. preprocessing data...
len(mu) = 0, len(d_std) = 0
the variance of the 18-th feature is 0.
the variance of the 24-th feature is 0.
**all_norm:59832, all_attack:35953
x_norm_train:(41881, 27), x_attack_train:(25166, 27)
x_norm_val:(5984, 27), x_attack_val:(3596, 27)
x_norm_test_UNB:(11967, 27), x_attack_test_UNB:(7191, 27)
x_norm_test_SYNT:(15598, 27), x_attack_test_SYNT:(74242, 27)
x_norm_test_MAWI:(12400, 27), x_attack_test_MAWI:0

Step 2. train and evaluate AE on case: uSc2C2_z-score_20_14

Step 2-1. train AE on case: uSc2C2_z-score_20_14
x_norm_train.shape: (41881, 27)
AE training for Case :  uSc2C2_z-score_20_14  =  233.996160030365 s
Train Loss =  0.3110618013500333 model.metrics_names ['loss']
Validation Loss =  0.28554240363166933 model.metrics_names ['loss']
optimal_thres_AE_val:1.5832585795320169, factor = 5, key = loss
Test AE on train set on case: uSc2C2_z-score_20_14
x_norm_train.shape: (41881, 27)
AE Test time for  uSc2C2_z-score_20_14  = :  1.124579668045044
[[    0     0]
 [ 1706 40175]]
tpr (recall): 0, fnr: 0, fpr: 0.04073446192784318, tnr: 0.9592655380721569, acc: 0.9592655380721569

Step 2-2. test AE on test set, case: uSc2C2_z-score_20_14

1)test AE on UNB test set
x_test_UNB.shape: (19158, 27)
AE Test time for  uSc2C2_z-score_20_14  = :  0.6603429317474365
[[ 6813   378]
 [  536 11431]]
tpr (recall): 0.9474342928660826, fnr: 0.052565707133917394, fpr: 0.04478983872315535, tnr: 0.9552101612768447, acc: 0.9522914709259839

2)test AE on SYNT test set
x_test_SYNT.shape: (89840, 27)
AE Test time for  uSc2C2_z-score_20_14  = :  2.059009075164795
[[74242     0]
 [15261   337]]
tpr (recall): 1.0, fnr: 0.0, fpr: 0.9783946659828183, tnr: 0.02160533401718169, acc: 0.8301313446126447

3)test AE on MAWI test set
x_test_MAWI.shape: (12400, 27)
AE Test time for  uSc2C2_z-score_20_14  = :  0.5309600830078125
[[    0     0]
 [12400     0]]
tpr (recall): 0, fnr: 0, fpr: 1.0, tnr: 0.0, acc: 0.0

Step 3. train and evaluate PCA , case: uSc2C2_z-score_20_14
PCA Training time for case uSc2C2_z-score_20_14  =  0.10135507583618164
x_norm_train.shape: (41881, 27)
PCA Testing Time :  0.030998706817626953
[[    0     0]
 [ 4188 37693]]
tpr (recall): 0, fnr: 0, fpr: 0.09999761228241924, tnr: 0.9000023877175808, acc: 0.9000023877175808
x_test_UNB.shape: (19158, 27)
PCA Testing Time :  0.01887798309326172
[[ 7191     0]
 [ 1150 10817]]
tpr (recall): 1.0, fnr: 0.0, fpr: 0.09609760173811314, tnr: 0.9039023982618869, acc: 0.9399728572919929
x_test_SYNT.shape: (89840, 27)
PCA Testing Time :  0.09391593933105469
[[74242     0]
 [15106   492]]
tpr (recall): 1.0, fnr: 0.0, fpr: 0.9684574945505834, tnr: 0.03154250544941659, acc: 0.8318566340160285
x_test_MAWI.shape: (12400, 27)
PCA Testing Time :  0.011905908584594727
[[    0     0]
 [12400     0]]
tpr (recall): 0, fnr: 0, fpr: 1.0, tnr: 0.0, acc: 0.0
/usr/local/lib/python3.6/site-packages/sklearn/ensemble/iforest.py:213: FutureWarning: default contamination parameter 0.1 will change in version 0.22 to "auto". This will change the predict method behavior.
  FutureWarning)
/usr/local/lib/python3.6/site-packages/sklearn/ensemble/iforest.py:223: FutureWarning: behaviour="old" is deprecated and will be removed in version 0.22. Please use behaviour="new", which makes the decision_function change to match other anomaly detection algorithm API.
  FutureWarning)

Step 4. train and evaluate IF, case: uSc2C2_z-score_20_14
IF Training time for case uSc2C2_z-score_20_14  =  2.276323080062866
x_norm_train.shape: (41881, 27)
/usr/local/lib/python3.6/site-packages/sklearn/ensemble/iforest.py:417: DeprecationWarning: threshold_ attribute is deprecated in 0.20 and will be removed in 0.22.
  " be removed in 0.22.", DeprecationWarning)
IF Testing Time :  1.0553398132324219
[[    0     0]
 [ 4188 37693]]
tpr (recall): 0, fnr: 0, fpr: 0.09999761228241924, tnr: 0.9000023877175808, acc: 0.9000023877175808
x_test_UNB.shape: (19158, 27)
/usr/local/lib/python3.6/site-packages/sklearn/ensemble/iforest.py:417: DeprecationWarning: threshold_ attribute is deprecated in 0.20 and will be removed in 0.22.
  " be removed in 0.22.", DeprecationWarning)
IF Testing Time :  0.501349925994873
[[ 3717  3474]
 [ 1161 10806]]
tpr (recall): 0.5168961201501877, fnr: 0.4831038798498123, fpr: 0.09701679618952118, tnr: 0.9029832038104788, acc: 0.7580645161290323
x_test_SYNT.shape: (89840, 27)
/usr/local/lib/python3.6/site-packages/sklearn/ensemble/iforest.py:417: DeprecationWarning: threshold_ attribute is deprecated in 0.20 and will be removed in 0.22.
  " be removed in 0.22.", DeprecationWarning)
IF Testing Time :  1.8823659420013428
[[73778   464]
 [10377  5221]]
tpr (recall): 0.9937501683683091, fnr: 0.0062498316316909565, fpr: 0.6652775996922682, tnr: 0.33472240030773176, acc: 0.8793299198575245
x_test_MAWI.shape: (12400, 27)
/usr/local/lib/python3.6/site-packages/sklearn/ensemble/iforest.py:417: DeprecationWarning: threshold_ attribute is deprecated in 0.20 and will be removed in 0.22.
  " be removed in 0.22.", DeprecationWarning)
IF Testing Time :  0.2946960926055908
[[   0    0]
 [9830 2570]]
tpr (recall): 0, fnr: 0, fpr: 0.792741935483871, tnr: 0.20725806451612902, acc: 0.20725806451612902

Step 5. train and evaluate OCSVM,  case: uSc2C2_z-score
SVM Training time for case uSc2C2_z-score  =  158.89436531066895
x_norm_train.shape: (41881, 27)
OCSVM Testing Time :  34.90209984779358
[[    0     0]
 [ 4188 37693]]
tpr (recall): 0, fnr: 0, fpr: 0.09999761228241924, tnr: 0.9000023877175808, acc: 0.9000023877175808
x_test_UNB.shape: (19158, 27)
OCSVM Testing Time :  15.4528329372406
[[ 7191     0]
 [ 1134 10833]]
tpr (recall): 1.0, fnr: 0.0, fpr: 0.09476059162697417, tnr: 0.9052394083730259, acc: 0.9408080175383652
x_test_SYNT.shape: (89840, 27)
OCSVM Testing Time :  58.88975691795349
[[74242     0]
 [15099   499]]
tpr (recall): 1.0, fnr: 0.0, fpr: 0.968008719066547, tnr: 0.031991280933453006, acc: 0.8319345503116652
x_test_MAWI.shape: (12400, 27)
OCSVM Testing Time :  10.063803911209106
[[    0     0]
 [12400     0]]
tpr (recall): 0, fnr: 0, fpr: 1.0, tnr: 0.0, acc: 0.0

Step 6. train and evaluate DT on case: uSc2C2_z-score_20_14

-Step 3-1. preprocessing data for DT ...
len(mu) = 0, len(d_std) = 0
the variance of the 18-th feature is 0.
the variance of the 24-th feature is 0.

With data balance, x_train.shape: (50332, 27)
 in which, x_norm_train_DT.shape: (25166, 27), and x_attack_train_DT.shape: (25166, 27)

-Step 3-2. train DT...

-Step 3-3. evaluate DT...
1) evaluate DT on train set
x_train_DT.shape: (50332, 27)
DT Testing Time :  0.003046751022338867
[[25162     4]
 [   27 25139]]
tpr (recall): 0.9998410553921958, fnr: 0.00015894460780418025, fpr: 0.0010728761026782166, tnr: 0.9989271238973217, acc: 0.9993840896447588
2) evaluate DT on UNB test set
x_test_UNB_DT.shape: (19158, 27)
DT Testing Time :  0.001873016357421875
[[ 7178    13]
 [   44 11923]]
tpr (recall): 0.9981921846752886, fnr: 0.001807815324711445, fpr: 0.003676777805632155, tnr: 0.9963232221943679, acc: 0.9970247416222988
3) evaluate DT on SYNT test set
x_test_SYNT_DT.shape: (89840, 27)
DT Testing Time :  0.00880885124206543
[[73703   539]
 [12512  3086]]
tpr (recall): 0.9927399585140486, fnr: 0.007260041485951349, fpr: 0.8021541223233748, tnr: 0.1978458776766252, acc: 0.8547306322350846
4) evaluate DT on MAWI test set
x_test_MAWI_DT.shape: (12400, 27)
DT Testing Time :  0.0008308887481689453
[[    0     0]
 [10788  1612]]
tpr (recall): 0, fnr: 0, fpr: 0.87, tnr: 0.13, acc: 0.13

@@@Experiment 3 on SYNT: uSc3C1_z-score_20_14
Step 1. loading data...

Step 2. train and evaluate AE on case: uSc3C1_z-score_20_14

+Step 2-1. preprocessing data for AE ...
len(mu) = 0, len(d_std) = 0
the variance of the 18-th feature is 0.
the variance of the 21-th feature is 0.
**all_norm:77988, all_attack:36242
x_norm_train:(54591, 27), x_attack_train:(25368, 27)
x_norm_val:(7799, 27), x_attack_val:(3625, 27)
x_norm_test:(15598, 27), x_attack_test:(7249, 27)
x_norm_test_2:(15598, 27), x_attack_test_2:(38000, 27)

+Step 2-1. train AE...
x_norm_train.shape: (54591, 27)
AE training for Case :  uSc3C1_z-score_20_14  =  331.4065408706665 s
Train Loss =  0.08535655258407901 model.metrics_names ['loss']
Validation Loss =  0.09860161374712245 model.metrics_names ['loss']
optimal_thres_AE_val:0.504531986717312

+Step 2-2. evaluate AE...

1) evaluate AE on train set
AE Test time for  uSc3C1_z-score_20_14  = :  2.564556121826172
[[25367     1]
 [ 1064 53527]]
tpr (recall): 0.9999605802585935, fnr: 3.941974140649637e-05, fpr: 0.019490392189188695, tnr: 0.9805096078108113, acc: 0.9866806738453457

2) evaluate AE on test set 1
x_test_1.shape: (22847, 27)
AE Test time for  uSc3C1_z-score_20_14  = :  1.2079198360443115
[[ 7249     0]
 [  315 15283]]
tpr (recall): 1.0, fnr: 0.0, fpr: 0.02019489678163867, tnr: 0.9798051032183613, acc: 0.9862126318553859

3) evaluate AE on test set 2
x_test_2.shape: (53598, 27)
AE Test time for  uSc3C1_z-score_20_14  = :  2.4687271118164062
[[38000     0]
 [  315 15283]]
tpr (recall): 1.0, fnr: 0.0, fpr: 0.02019489678163867, tnr: 0.9798051032183613, acc: 0.9941229150341431

--save and show the reconstruction errors of normal and attack samples
output_pre_path:uSc3C1_z-score_20_14_recon_err_test_1
*the maximize reconstrcution error is 118.97420270779742 for Reconstruction loss of normal samples
Reconstr: out_file:Figures/uSc3C1_z-score_20_14_recon_err_test_1_reconstruct_loss_normal_data_rescon.pdf
*the maximize reconstrcution error is 118.97420270779742 for Reconstruction loss of normal samples in samples' order
*the maximize reconstrcution error is 170.9081964550072 for Reconstruction loss of attack samples
Reconstr: out_file:Figures/uSc3C1_z-score_20_14_recon_err_test_1_reconstruct_loss_attack_data_rescon.pdf
*the maximize reconstrcution error is 170.9081964550072 for Reconstruction loss of attack samples in samples' order
output_pre_path:uSc3C1_z-score_20_14_recon_err_test2
*the maximize reconstrcution error is 118.97420270779742 for Reconstruction loss of normal samples
Reconstr: out_file:Figures/uSc3C1_z-score_20_14_recon_err_test2_reconstruct_loss_normal_data_rescon.pdf
*the maximize reconstrcution error is 118.97420270779742 for Reconstruction loss of normal samples in samples' order
*the maximize reconstrcution error is 170.16691813939738 for Reconstruction loss of attack samples
Reconstr: out_file:Figures/uSc3C1_z-score_20_14_recon_err_test2_reconstruct_loss_attack_data_rescon.pdf
*the maximize reconstrcution error is 170.16691813939738 for Reconstruction loss of attack samples in samples' order

Step 3. train and evaluate DT on case: uSc3C1_z-score_20_14

-Step 3-1. preprocessing data for DT ...
len(mu) = 0, len(d_std) = 0
the variance of the 18-th feature is 0.
the variance of the 21-th feature is 0.

With data balance, x_train.shape: (50736, 27)
 in which, x_norm_train_DT.shape: (25368, 27), and x_attack_train_DT.shape: (25368, 27)

-Step 3-2. train DT...

-Step 3-3. evaluate DT...
1) evaluate DT on train set
x_train_DT.shape: (50736, 27)
DT Testing Time :  0.002850770950317383
[[25367     1]
 [    0 25368]]
tpr (recall): 0.9999605802585935, fnr: 3.941974140649637e-05, fpr: 0.0, tnr: 1.0, acc: 0.9999802901292968
2) evaluate DT on test set 1
x_test_1_DT.shape: (22847, 27)
DT Testing Time :  0.0020341873168945312
[[ 7247     2]
 [    6 15592]]
tpr (recall): 0.999724099875845, fnr: 0.00027590012415505585, fpr: 0.0003846647006026414, tnr: 0.9996153352993974, acc: 0.9996498446185494
3) evaluate DT on test set 2
x_test_2_DT.shape: (53598, 27)
DT Testing Time :  0.006448030471801758
[[37992     8]
 [    6 15592]]
tpr (recall): 0.9997894736842106, fnr: 0.0002105263157894737, fpr: 0.0003846647006026414, tnr: 0.9996153352993974, acc: 0.9997387962237397

@@@Experiment 3 on UNB: uSc3C2_z-score_20_14
Step 1. loading data...

Step 2. train and evaluate AE on case: uSc3C2_z-score_20_14

+Step 2-1. preprocessing data for AE ...
len(mu) = 0, len(d_std) = 0
the variance of the 18-th feature is 0.
the variance of the 24-th feature is 0.
**all_norm:59832, all_attack:35953
x_norm_train:(41881, 27), x_attack_train:(25166, 27)
x_norm_val:(5984, 27), x_attack_val:(3596, 27)
x_norm_test:(11967, 27), x_attack_test:(7191, 27)
x_norm_test_2:(11967, 27), x_attack_test_2:(74242, 27)

+Step 2-1. train AE...
x_norm_train.shape: (41881, 27)
AE training for Case :  uSc3C2_z-score_20_14  =  279.16352581977844 s
Train Loss =  0.31132253140388294 model.metrics_names ['loss']
Validation Loss =  0.28977385713136133 model.metrics_names ['loss']
optimal_thres_AE_val:1.4769766749863955

+Step 2-2. evaluate AE...

1) evaluate AE on train set
AE Test time for  uSc3C2_z-score_20_14  = :  1.7698869705200195
[[22814  2352]
 [ 1338 40543]]
tpr (recall): 0.906540570611142, fnr: 0.09345942938885798, fpr: 0.03194766123062964, tnr: 0.9680523387693704, acc: 0.9449639804912972

2) evaluate AE on test set 1
x_test_1.shape: (19158, 27)
AE Test time for  uSc3C2_z-score_20_14  = :  0.8785290718078613
[[ 6565   626]
 [  394 11573]]
tpr (recall): 0.9129467389792797, fnr: 0.08705326102072035, fpr: 0.032923873986797025, tnr: 0.967076126013203, acc: 0.9467585342937677

3) evaluate AE on test set 2
x_test_2.shape: (86209, 27)
AE Test time for  uSc3C2_z-score_20_14  = :  2.1900570392608643
[[74242     0]
 [  394 11573]]
tpr (recall): 1.0, fnr: 0.0, fpr: 0.032923873986797025, tnr: 0.967076126013203, acc: 0.995429711515039

--save and show the reconstruction errors of normal and attack samples
output_pre_path:uSc3C2_z-score_20_14_recon_err_test_1
*the maximize reconstrcution error is 24.415217496130616 for Reconstruction loss of normal samples
Reconstr: out_file:Figures/uSc3C2_z-score_20_14_recon_err_test_1_reconstruct_loss_normal_data_rescon.pdf
*the maximize reconstrcution error is 24.415217496130616 for Reconstruction loss of normal samples in samples' order
*the maximize reconstrcution error is 156.5196152139171 for Reconstruction loss of attack samples
Reconstr: out_file:Figures/uSc3C2_z-score_20_14_recon_err_test_1_reconstruct_loss_attack_data_rescon.pdf
*the maximize reconstrcution error is 156.5196152139171 for Reconstruction loss of attack samples in samples' order
output_pre_path:uSc3C2_z-score_20_14_recon_err_test2
*the maximize reconstrcution error is 43.05474938725877 for Reconstruction loss of normal samples
Reconstr: out_file:Figures/uSc3C2_z-score_20_14_recon_err_test2_reconstruct_loss_normal_data_rescon.pdf
*the maximize reconstrcution error is 43.05474938725877 for Reconstruction loss of normal samples in samples' order
*the maximize reconstrcution error is 3519.1474562625294 for Reconstruction loss of attack samples
Reconstr: out_file:Figures/uSc3C2_z-score_20_14_recon_err_test2_reconstruct_loss_attack_data_rescon.pdf
*the maximize reconstrcution error is 3519.1474562625294 for Reconstruction loss of attack samples in samples' order

Step 3. train and evaluate DT on case: uSc3C2_z-score_20_14

-Step 3-1. preprocessing data for DT ...
len(mu) = 0, len(d_std) = 0
the variance of the 18-th feature is 0.
the variance of the 24-th feature is 0.

With data balance, x_train.shape: (50332, 27)
 in which, x_norm_train_DT.shape: (25166, 27), and x_attack_train_DT.shape: (25166, 27)

-Step 3-2. train DT...

-Step 3-3. evaluate DT...
1) evaluate DT on train set
x_train_DT.shape: (50332, 27)
DT Testing Time :  0.003074169158935547
[[25162     4]
 [   27 25139]]
tpr (recall): 0.9998410553921958, fnr: 0.00015894460780418025, fpr: 0.0010728761026782166, tnr: 0.9989271238973217, acc: 0.9993840896447588
2) evaluate DT on test set 1
x_test_1_DT.shape: (19158, 27)
DT Testing Time :  0.002157926559448242
[[ 7179    12]
 [   45 11922]]
tpr (recall): 0.9983312473925741, fnr: 0.001668752607425949, fpr: 0.0037603409375783405, tnr: 0.9962396590624216, acc: 0.9970247416222988
3) evaluate DT on test set 2
x_test_2_DT.shape: (86209, 27)
DT Testing Time :  0.006880998611450195
[[73701   541]
 [   45 11922]]
tpr (recall): 0.9927130195846017, fnr: 0.007286980415398292, fpr: 0.0037603409375783405, tnr: 0.9962396590624216, acc: 0.9932025658573931

Process finished with exit code 0
